<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Hub::Webapp::Client</title>
<link rel="stylesheet" href="../../pod.css" type="text/css" />
<link rev="made" href="mailto:gerrit@familiehaase.de" />
</head>

<body>

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#methods">METHODS</a></li>
	<li><a href="#internal">INTERNAL</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#copyright">COPYRIGHT</a></li>
	<li><a href="#updated">UPDATED</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>Hub::Webapp::Client -</p>
<p>Part of the <a href="../../hublib.html">Hub Library</a></p>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="methods">METHODS</a></h1>
<table><tr><td>
<a class="methlink" href="#item_clean">clean</a></td><td>
<a class="methlink" href="#item_getclientcookie">getclientcookie</a></td><td>
<a class="methlink" href="#item_mkurl">mkurl</a></td><td>
<a class="methlink" href="#item_save">save</a></td><td>
<a class="methlink" href="#item_upload">upload</a></td></tr><tr><td>
<a class="methlink" href="#item_clear">clear</a></td><td>
<a class="methlink" href="#item_has">has</a></td><td>
<a class="methlink" href="#item_new">new</a></td><td>
<a class="methlink" href="#item_set">set</a></td></tr><tr><td>
<a class="methlink" href="#item_endreq">endreq</a></td><td>
<a class="methlink" href="#item_load">load</a></td><td>
<a class="methlink" href="#item_newreq">newreq</a></td><td>
<a class="methlink" href="#item_setrelay">setrelay</a></td></tr><tr><td>
<a class="methlink" href="#item_get">get</a></td><td>
<a class="methlink" href="#item_logreq">logreq</a></td><td>
<a class="methlink" href="#item_restorereq">restorereq</a></td><td>
<a class="methlink" href="#item_take">take</a></td></tr></table><dl>
<dt><strong><a name="item_clean">clean</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: clean</pre>
</dd>
<dd>
<p>Clear everything but in-use data</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_clear">clear</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: clear</pre>
</dd>
<dd>
<p>Clear all session data</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_endreq">endreq</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: endreq</pre>
</dd>
<dd>
<p>Ends the request (saves session to disk)</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_get">get</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: get KEY</pre>
</dd>
<dd>
<p>Directly get by key</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_getclientcookie">getclientcookie</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: getclientcookie</pre>
</dd>
<dd>
<p>Print the client key as a cookie</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_has">has</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: has KEY</pre>
</dd>
<dd>
<p>Return 1 if the specified element is defined, 0 if not.</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_load">load</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: load</pre>
</dd>
<dd>
<p>Load a session file.  Note that this *takes over* the current request. Most
notably, this loaded file is resaved when <a href="#item_endreq"><code>endreq()</code></a> is called.</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_logreq">logreq</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: logreq</pre>
</dd>
<dd>
<p>Log request state information</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_mkurl">mkurl</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: mkurl CGIPARAMS, [OPTIONS]
 Usage: mkurl OPTIONS
 Usage: mkurl</pre>
</dd>
<dd>
<p>Create url with current context information.  Parameters encountered first
take prescedence.</p>
</dd>
<dd>
<p>Where, CGIPARAMS can be:</p>
</dd>
<dd>
<pre>
  SCALAR          &quot;name=George;_action=assisinate;time=yesterday&quot;</pre>
</dd>
<dd>
<pre>
  HASHREF         {
                      name    =&gt; &quot;George&quot;,
                      _action =&gt; &quot;assasinate&quot;,
                      time    =&gt; &quot;yesterday&quot;,
                  }</pre>
</dd>
<dd>
<pre>
  ARRAYREF        [
                      &quot;name=&quot;George&quot;,
                      &quot;_action=&quot;assasinate&quot;,
                      &quot;time=&quot;yesterday&quot;,
                  ]</pre>
</dd>
<dd>
<p>And, OPTIONS can be:</p>
</dd>
<dd>
<pre>
  --noparams      No parameters</pre>
</dd>
<dd>
<pre>
  --referrer      Create a link to the referring page</pre>
</dd>
<dd>
<pre>
  --lastreq       Link to the last request (even if it's the same handler)</pre>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_new">new</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: new
 Usage: new CLIENTDIR</pre>
</dd>
<dd>
<p>Constructor.</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_newreq">newreq</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: newreq
 Usage: newreq CGI-&gt;new()
 Usage: newreq &quot;_display=login&amp;s_username=ryan&quot;
 Usage: newreq &quot;_display=login&quot;, &quot;s_username=ryan&quot;</pre>
</dd>
<dd>
<p>Come to life</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_restorereq">restorereq</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: restorereq LEVEL</pre>
</dd>
<dd>
<p>Restore a request from the history.</p>
</dd>
<dd>
<p>Where LEVEL can be:</p>
</dd>
<dd>
<pre>
  0       Current request (no operation performed)
  1       Last request
  2       The one before the last
  3       The one before that
  4       The one before that
  max     No-op, you cannot go back farther than: REQHISTORYSIZE - 1</pre>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_save">save</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: save</pre>
</dd>
<dd>
<p>Write to disk</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_set">set</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: set KEY, DATA</pre>
</dd>
<dd>
<p>Directly set by key</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_setrelay">setrelay</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: setrelay( &quot;login&quot; );
 Usage: setrelay( &quot;login&quot;, &quot;username=ryan&amp;password=&quot; );
 Usage: setrelay( &quot;login&quot;, &quot;username=ryan&quot;, &quot;password=&quot; );</pre>
</dd>
<dd>
<p>Set relay (next handler and parameters) data</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_take">take</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: take KEY</pre>
</dd>
<dd>
<p>Directly get by key, then delete it</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_upload">upload</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: upload</pre>
</dd>
<dd>
<p>Upload multi-part form data</p>
</dd>
<p></p></dl>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="internal">INTERNAL</a></h1>
<table><tr><td>
<a class="methlink" href="#item_autoload">AUTOLOAD</a></td><td>
<a class="methlink" href="#item__mkcgiinst">_mkcgiinst</a></td><td>
<a class="methlink" href="#item__refresh">_refresh</a></td><td>
<a class="methlink" href="#item__setreqkey">_setreqkey</a></td></tr><tr><td>
<a class="methlink" href="#item_destroy">DESTROY</a></td><td>
<a class="methlink" href="#item__mkfilename">_mkfilename</a></td><td>
<a class="methlink" href="#item__setclientkey">_setclientkey</a></td><td>
<a class="methlink" href="#item__validate">_validate</a></td></tr><tr><td>
<a class="methlink" href="#item__init">_init</a></td><td>
<a class="methlink" href="#item__parsecgi">_parsecgi</a></td><td>
<a class="methlink" href="#item__setmeta">_setmeta</a></td></tr></table><dl>
<dt><strong><a name="item_autoload">AUTOLOAD</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: AUTOLOAD</pre>
</dd>
<dd>
<p>Autoload get/set/take/has calls and translate them into correct instance
method calls.</p>
</dd>
<dd>
<p>The method name is translated as:</p>
</dd>
<dd>
<pre>
  $class-&gt;aaabbb( ... )</pre>
</dd>
<dd>
<pre>
  aaa     Is the method part, and can be:</pre>
</dd>
<dd>
<pre>
              get|set|take|has</pre>
</dd>
<dd>
<pre>
  bbb     Is the root identifier part.  I can be anything, but these
          special ones are re-routed:</pre>
</dd>
<dd>
<pre>
              current|signal|base</pre>
</dd>
<dd>
<p>If the aaa part is not one of the four, an error is logged.</p>
</dd>
<dd>
<p>If the bbb part is not of the two special ones, then it is considerred to be
the id of the root hash whithin which we will handle data.</p>
</dd>
<dd>
<p>A bbb part of 'current' sets the bbb part to the current handler.</p>
</dd>
<dd>
<p>A bbb part of 'signal' is the same as 'current' in display context, but if we
are inside an action request, 'signal' is re-routed to the action hash (where
the action signals are stored.)</p>
</dd>
<dd>
<p>Given that were invoked by a request of:</p>
</dd>
<dd>
<pre>
  .=p001;..=index;_id=42;name=joe</pre>
</dd>
<dd>
<pre>
 Then                              Becomes                             Returns</pre>
</dd>
<dd>
<pre>
  getsignal( &quot;id&quot; )               get-&gt;( &quot;p001:id&quot; )                  42
  setcurrent( &quot;id&quot;, 1002 )        set-&gt;( &quot;p001:id&quot;, 43 )</pre>
</dd>
<dd>
<p>and subsequently invoked with a request of:</p>
</dd>
<dd>
<pre>
  .=p001;..=index;_action=print;_id=1001;name=jimmy</pre>
</dd>
<dd>
<pre>
 Then                              Becomes                             Returns</pre>
</dd>
<dd>
<pre>
  getsignal( &quot;id&quot; )               get-&gt;( &quot;ACTION:id&quot; )                1001
  setcurrent( &quot;id&quot;, 1002 )        set-&gt;( &quot;p001:id&quot;, 1002 )
  getcurrent( &quot;name&quot; )            get-&gt;( &quot;p001:name&quot; )                joe
  getsignal( &quot;name&quot; )             get-&gt;( &quot;ACTION:name&quot; )              jimmy
  getaction( &quot;name&quot; )             get-&gt;( &quot;ACTION:name&quot; )              jimmy</pre>
</dd>
<dd>
<p>And for any other bbb part:</p>
</dd>
<dd>
<pre>
 This                              Becomes</pre>
</dd>
<dd>
<pre>
  getfoo( &quot;id&quot; )                  get-&gt;( &quot;FOO:id&quot; )
  setFoo( &quot;id&quot;, 1004 )            error!
  set_Foo( &quot;id&quot;, 1004 )           error!
  set_foo( &quot;id&quot;, 1004 )           error!
  setfoo( &quot;user:name&quot;, &quot;joe&quot; )    set-&gt;( &quot;FOO:user:name&quot;, &quot;joe&quot; )
  hasjunk( &quot;mail&quot; )               has-&gt;( &quot;JUNK:mail&quot; )
  takeunk( &quot;mail&quot; )               has-&gt;( &quot;JUNK:mail&quot; )</pre>
</dd>
<dd>
<p>SUBREQUESTS</p>
</dd>
<dd>
<p>A bbb part of 'base' sets the bbb part to the base handler hash.  This is
use to share data in subrequests. Here are three requests, where the second
two are subrequests:</p>
</dd>
<dd>
<pre>
  1) .=p001;_view=ltr
  2) .=p001:summary;_sort=date
  3) .=p001:summary:print;_orientation=landscape</pre>
</dd>
<dd>
<p>In the third request, the following happens:</p>
</dd>
<dd>
<pre>
  getbase( &quot;view&quot; )               ltr
  getsignal( &quot;orientation&quot; )      landscape
  getsignal( &quot;sort&quot; )
  getmeta( &quot;handler&quot; )            p001:summary:print
  getmeta( &quot;baseid&quot; )             p001
  getmeta( &quot;reqid1&quot; )             summary
  getmeta( &quot;reqid2&quot; )             print</pre>
</dd>
<dd>
<p>NOTE: The data hash for the above is:</p>
</dd>
<dd>
<pre>
  %p001{
      sort == 1
      %summary{
          %print{
              orientation == landscape
          }
          sort == date
      }
      view == ltr
  }</pre>
</dd>
<dd>
<p>The subrequest 'summary' is stored under the base request 'p001', which means
that you would cause problems where you to:</p>
</dd>
<dd>
<pre>
  .=p001;_summary=on</pre>
</dd>
<dd>
<pre>
  -or-</pre>
</dd>
<dd>
<pre>
  setbase( &quot;summary&quot;, &quot;on&quot; )</pre>
</dd>
<dd>
<p>as you would be overwriting the nested data.</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item_destroy">DESTROY</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
          Hub::lmsg( &quot;EVAL: $eval&quot; );</pre>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item__init">_init</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: _init
 Usage: _init CLIENTDIR</pre>
</dd>
<dd>
<p>Called by new, initialze members.</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item__mkcgiinst">_mkcgiinst</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: _mkcgiinst</pre>
</dd>
<dd>
<p>Make CGI instance</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item__mkfilename">_mkfilename</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: _mkfilename SUBDIR</pre>
</dd>
<dd>
<p>Make the path to the session file</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item__parsecgi">_parsecgi</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: _parsecgi</pre>
</dd>
<dd>
<p>Populate ourselves with new data recieved through the CGI.  Also handle
system (.) parameters.</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item__refresh">_refresh</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: _refresh</pre>
</dd>
<dd>
<p>Called by newreq, initialize members</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item__setclientkey">_setclientkey</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: _setclientkey</pre>
</dd>
<dd>
<p>1) Use the client key specified in a cookie
2) Or, use the .clientkey CGI parameter
3) Or, generate a new key</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item__setmeta">_setmeta</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: _setmeta</pre>
</dd>
<dd>
<p>Set metadata members</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item__setreqkey">_setreqkey</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: _setreqkey</pre>
</dd>
<dd>
<p>Generate unique request key</p>
</dd>
<p></p></dl>
<dl>
<dt><strong><a name="item__validate">_validate</a></strong><br />
</dt>
<dd>
<strong></strong>
</dd>
<dd>
<pre>
 Usage: _validate</pre>
</dd>
<dd>
<p>Check for timeout and misconfigurations</p>
</dd>
<p></p></dl>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Ryan Gies</p>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright (c) 2006 Livesite Networks, LLC.  All rights reserved.</p>
<p>Copyright (c) 2000-2005 Ryan Gies.  All rights reserved.</p>
<p>
<a href="#__index__"><small>Top</small></a>
</p>
<hr />
<h1><a name="updated">UPDATED</a></h1>
<p>This file created by  on  at</p>
<p><a href="#__index__"><small>Top</small></a></p>

</body>

</html>
